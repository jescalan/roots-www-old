(function(e,t,n,r,i){var s=e(r),o="waypoint.reached",u=function(e,n){e.element.trigger(o,n),e.options.triggerOnce&&e.element[t]("destroy")},a=function(e,t){if(!t)return-1;var n=t.waypoints.length-1;while(n>=0&&t.waypoints[n].element[0]!==e[0])n-=1;return n},f=[],l=function(t){e.extend(this,{element:e(t),oldScroll:0,waypoints:[],didScroll:!1,didResize:!1,doScroll:e.proxy(function(){var t=this.element.scrollTop(),r=t>this.oldScroll,i=this,s=e.grep(this.waypoints,function(e,n){return r?e.offset>i.oldScroll&&e.offset<=t:e.offset<=i.oldScroll&&e.offset>t}),o=s.length;(!this.oldScroll||!t)&&e[n]("refresh"),this.oldScroll=t;if(!o)return;r||s.reverse(),e.each(s,function(e,t){(t.options.continuous||e===o-1)&&u(t,[r?"down":"up"])})},this)}),e(t).bind("scroll.waypoints",e.proxy(function(){this.didScroll||(this.didScroll=!0,r.setTimeout(e.proxy(function(){this.doScroll(),this.didScroll=!1},this),e[n].settings.scrollThrottle))},this)).bind("resize.waypoints",e.proxy(function(){this.didResize||(this.didResize=!0,r.setTimeout(e.proxy(function(){e[n]("refresh"),this.didResize=!1},this),e[n].settings.resizeThrottle))},this)),s.load(e.proxy(function(){this.doScroll()},this))},c=function(t){var n=null;return e.each(f,function(e,r){if(r.element[0]===t)return n=r,!1}),n},h={init:function(r,i){return this.each(function(){var s=e.fn[t].defaults.context,u,h=e(this);i&&i.context&&(s=i.context),e.isWindow(s)||(s=h.closest(s)[0]),u=c(s),u||(u=new l(s),f.push(u));var p=a(h,u),d=p<0?e.fn[t].defaults:u.waypoints[p].options,v=e.extend({},d,i);v.offset=v.offset==="bottom-in-view"?function(){var t=e.isWindow(s)?e[n]("viewportHeight"):e(s).height();return t-e(this).outerHeight()}:v.offset,p<0?u.waypoints.push({element:h,offset:null,options:v}):u.waypoints[p].options=v,r&&h.bind(o,r),i&&i.handler&&h.bind(o,i.handler)}),e[n]("refresh"),this},remove:function(){return this.each(function(t,n){var r=e(n);e.each(f,function(e,t){var n=a(r,t);n>=0&&(t.waypoints.splice(n,1),t.waypoints.length||(t.element.unbind("scroll.waypoints resize.waypoints"),f.splice(e,1)))})})},destroy:function(){return this.unbind(o)[t]("remove")}},p={refresh:function(){e.each(f,function(t,r){var i=e.isWindow(r.element[0]),s=i?0:r.element.offset().top,o=i?e[n]("viewportHeight"):r.element.height(),a=i?0:r.element.scrollTop();e.each(r.waypoints,function(e,t){if(!t)return;var n=t.options.offset,i=t.offset;if(typeof t.options.offset=="function")n=t.options.offset.apply(t.element);else if(typeof t.options.offset=="string"){var f=parseFloat(t.options.offset);n=t.options.offset.indexOf("%")?Math.ceil(o*(f/100)):f}t.offset=t.element.offset().top-s+a-n;if(t.options.onlyOnScroll)return;i!==null&&r.oldScroll>i&&r.oldScroll<=t.offset?u(t,["up"]):i!==null&&r.oldScroll<i&&r.oldScroll>=t.offset?u(t,["down"]):!i&&r.element.scrollTop()>t.offset&&u(t,["down"])}),r.waypoints.sort(function(e,t){return e.offset-t.offset})})},viewportHeight:function(){return r.innerHeight?r.innerHeight:s.height()},aggregate:function(){var t=e();return e.each(f,function(n,r){e.each(r.waypoints,function(e,n){t=t.add(n.element)})}),t}};e.fn[t]=function(n){if(h[n])return h[n].apply(this,Array.prototype.slice.call(arguments,1));if(typeof n=="function"||!n)return h.init.apply(this,arguments);if(typeof n=="object")return h.init.apply(this,[null,n]);e.error("Method "+n+" does not exist on jQuery "+t)},e.fn[t].defaults={continuous:!0,offset:0,triggerOnce:!1,context:r},e[n]=function(e){return p[e]?p[e].apply(this):p.aggregate()},e[n].settings={resizeThrottle:200,scrollThrottle:100},s.load(function(){e[n]("refresh")})})(jQuery,"waypoint","waypoints",window)